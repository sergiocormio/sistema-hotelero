<?xml version="1.0" encoding="utf-8"?>
<s:HGroup xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" width="100%" height="100%" xmlns:forms="view.forms.*" xmlns:crud="view.forms.crud.*"
		 creationComplete="init(event)">
	<fx:Script>
		<![CDATA[
			import mx.core.IVisualElement;
			import mx.events.FlexEvent;
			
			import resources.icons.Icons;
			[Bindable]
			public var loc:Object;
			
			protected function init(event:FlexEvent):void
			{
				transferCRUDForm.addEventListener("transferHasChanged",transferHasChanged);
			}
			
			//Every Transfer change calendarTransfer have to refresh its grid
			private function transferHasChanged(evt:Object):void {
				transferCalendar.refreshCalendar();
			}
			
			public function refreshForm():void{
				var content:NavigatorContent = transferViewStack.selectedChild as NavigatorContent;
				var element:IVisualElement = content.getElementAt(0);
				if(element==transferCalendar){
					transferCalendar.refreshForm();
				}else if(element==transferCRUDForm){
					transferCRUDForm.refreshForm();
				}
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<s:ButtonBar dataProvider="{transferViewStack}" requireSelection="true" iconPlacement="top" horizontalCenter="0" verticalCenter="0" height="100%">
		<s:layout>
			<s:TileLayout verticalGap="12" requestedColumnCount="1"/>
		</s:layout>
	</s:ButtonBar>
	
	<mx:ViewStack id="transferViewStack" borderStyle="none" width="100%" height="100%" creationPolicy="all" change="refreshForm();">
		<s:NavigatorContent id="schedule" label="{loc.transfer.schedule}" icon="{Icons.calendar}" width="100%" height="100%" >
			<forms:TransferCalendar id="transferCalendar" width="100%" height="100%" loc="{loc}"/>
		</s:NavigatorContent>
		<s:NavigatorContent id="transferCRUD" label="{loc.transfer.plural}" icon="{Icons.needle}" width="100%" height="100%" >
			<crud:TransferCRUDForm id="transferCRUDForm" width="100%" height="100%" loc="{loc}"/>
		</s:NavigatorContent>
	</mx:ViewStack>
</s:HGroup>
